25/10/14 16:49:44 WARN Utils: Your hostname, Simarpals-MacBook-Air-3.local resolves to a loopback address: 127.0.0.1; using 192.168.0.102 instead (on interface en0)
25/10/14 16:49:44 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
25/10/14 16:49:45 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/bivariate.py:112: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/bivariate.py:168: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/bivariate.py:240: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()

=== CREATING DERIVED COLUMNS ===
✓ Derived columns created successfully!

================================================================================
PRICE VS CANCELLATION RATE
================================================================================
Cancellation by Price Category:
+------------------+--------------+-----------------+----------------+------------------+------------------+
|    price_category|total_bookings|canceled_bookings|cancelation_rate|         avg_price| avg_booking_value|
+------------------+--------------+-----------------+----------------+------------------+------------------+
|    Budget ($0-50)|          8860|             1866|            21.1| 32.29429458239247|110.93839051918773|
|     Mid ($51-100)|         40123|            15673|            39.1|  76.5051730927398| 253.9134159958099|
|Premium ($101-150)|         21446|             8132|            37.9|120.63356057073632| 401.1170474680602|
|    Luxury (>$150)|          8274|             2808|            33.9| 187.3932173072283| 714.9721331883001|
+------------------+--------------+-----------------+----------------+------------------+------------------+

✓ Saved: bivariate/price_vs_cancellation.png

================================================================================
LEAD TIME VS CANCELLATION RATE
================================================================================
Lead Time vs Price Analysis:
+--------------------+--------------+------------------+------------------+----------------+------------------+
|  lead_time_category|total_bookings|         avg_price|     avg_lead_time|cancelation_rate| avg_booking_value|
+--------------------+--------------+------------------+------------------+----------------+------------------+
|Last Minute (≤7 d...|         13925| 87.32112890484738| 2.278850987432675|            10.0|186.97423842010775|
|Short Term (8-30 ...|         12602|102.88138708141571| 17.68814473893033|            26.5|321.69864783367746|
|Medium Term (31-9...|         20140|101.50586742800488| 57.08108242303873|            35.5|364.65356156901487|
|Long Term (>90 days)|         32036| 91.66429017355554|205.02687601448372|            51.8| 364.8062304906949|
+--------------------+--------------+------------------+------------------+----------------+------------------+

✓ Saved: bivariate/lead_time_impact.png

================================================================================
STAY DURATION VS MARKET SEGMENT
================================================================================
Stay Duration by Market Segment (Top combinations):
+-------------------+--------------------+--------+------------------+----------------+------------------+
|market_segment_type|       stay_category|bookings|         avg_price|cancelation_rate| avg_booking_value|
+-------------------+--------------------+--------+------------------+----------------+------------------+
|          Online TA|          4-7 Nights|   12818|108.86519035730976|            37.0| 545.7622585426711|
|          Online TA|            3 Nights|    7283| 113.6759755595217|            35.2| 341.0279266785666|
|             Groups|            2 Nights|    6207| 72.31362332849946|            71.3|144.62724665699892|
|          Online TA|            2 Nights|    6184|113.82925452781305|            31.7| 227.6585090556261|
|          Online TA|             1 Night|    6059|104.98731473840516|            24.3|104.98731473840516|
|      Offline TA/TO|          4-7 Nights|    5585| 78.75271441360763|            22.5| 429.4370528200545|
|      Offline TA/TO|            3 Nights|    5104| 87.92871669278998|            46.3|263.78615007836993|
|      Offline TA/TO|            2 Nights|    4590| 91.59669063180824|            43.9| 183.1933812636165|
|             Groups|            3 Nights|    3354| 79.13204531902167|            53.7|237.39613595706734|
|             Groups|          4-7 Nights|    3068| 76.94825945241205|            53.1|366.65953389830554|
|             Direct|             1 Night|    2722| 97.61823291697289|            12.0| 97.61823291697289|
|             Direct|          4-7 Nights|    2289|119.89162953254697|            16.3| 636.5568414154657|
|      Offline TA/TO|             1 Night|    2088| 81.75961206896547|            29.8| 81.75961206896547|
|          Corporate|             1 Night|    1907|  65.8241478762454|            14.2|  65.8241478762454|
|          Online TA|Long Stay (>7 nig...|    1482|108.18176113360339|            50.2|1131.4639406207837|
|             Direct|            2 Nights|    1400| 103.4603499999999|            14.9| 206.9206999999998|
|      Offline TA/TO|Long Stay (>7 nig...|    1185| 81.00745991561193|            11.7| 919.6402447257382|
|             Groups|             1 Night|    1173| 76.84258312020464|            64.6| 76.84258312020464|
|             Direct|            3 Nights|    1122|117.57139928698746|            16.9|352.71419786096277|
|          Corporate|            2 Nights|     892| 74.86874439461883|            16.6|149.73748878923766|
+-------------------+--------------------+--------+------------------+----------------+------------------+
only showing top 20 rows


================================================================================
WEEKEND VS WEEKDAY BY COUNTRY
================================================================================
Weekend vs Weekday Preferences by Top Countries:
+-------+--------------+------------------+------------------+----------------+
|country|total_bookings|avg_weekend_nights|avg_weekday_nights|cancelation_rate|
+-------+--------------+------------------+------------------+----------------+
|    PRT|         35628|0.7235881890647805|2.1611934433591555|            56.1|
|    GBR|          6941|1.3944676559573548|3.5528021898861835|            16.1|
|    FRA|          6513|0.9286043298019346| 2.477660064486412|            14.5|
|    ESP|          5956|0.8628274009402284|  2.19543317662861|            21.9|
|    DEU|          4389|0.9444064707222602|2.4515835042150833|            13.3|
|    ITA|          2453| 0.977986139421117|2.1960864247859764|            32.1|
|    IRL|          1972| 1.518762677484787| 3.834685598377282|            19.4|
|    BEL|          1344|1.0386904761904763|2.5074404761904763|            16.7|
|    NLD|          1300|1.0723076923076924| 2.669230769230769|            15.5|
|    BRA|          1214|0.9827018121911038| 2.411037891268534|            31.8|
+-------+--------------+------------------+------------------+----------------+

✓ Saved: bivariate/country_preferences_heatmap.png

================================================================================
SEASONAL PATTERNS BY HOTEL TYPE
================================================================================
Seasonal Patterns by Hotel Type (Top months):
+------------+-------------+--------+------------------+----------------+------------------+
|       hotel|arrival_month|bookings|         avg_price|cancelation_rate| avg_booking_value|
+------------+-------------+--------+------------------+----------------+------------------+
|  City Hotel|      October|    7605| 99.97449835634443|            43.0|278.94237343852717|
|  City Hotel|    September|    7400|110.00466081081109|            42.0|316.72508378378353|
|  City Hotel|       August|    5858|101.48057698873302|            42.3|310.88835268009524|
|  City Hotel|         July|    4529| 98.76590417310632|            43.8|307.00439832192507|
|  City Hotel|     November|    4357| 88.06960064264416|            38.1|268.12058526509037|
|  City Hotel|     December|    4132| 88.82630687318493|            42.1| 289.2321103581802|
|  City Hotel|         June|    3923|108.88757073668091|            43.8| 300.2475121080806|
|  City Hotel|          May|    3676|108.63998367791069|            39.1|309.07828073993466|
|  City Hotel|        April|    3561| 99.54970513900577|            43.2|292.05769446784603|
|Resort Hotel|      October|    3555|62.097617440224845|            27.5|249.84324894514788|
|Resort Hotel|    September|    3108| 93.25203024453059|            32.4|446.63821106821297|
|Resort Hotel|       August|    3094|174.83230769230735|            30.5| 896.8671396250805|
|  City Hotel|        March|    3046| 91.90064018384768|            36.4| 279.2216776099807|
|Resort Hotel|         July|    2819| 141.1821851720465|            27.5|  732.292178077332|
|Resort Hotel|     December|    2648| 68.98422960725051|            23.8| 228.5066540785495|
|Resort Hotel|     November|    2437|48.273992613869645|            18.9|177.24872794419386|
|  City Hotel|     February|    2371| 79.97678194854498|            39.2| 230.6069843947703|
|Resort Hotel|        April|    1867| 68.64242099625052|            28.0| 258.6859560792714|
|Resort Hotel|          May|    1802| 71.42880688124286|            26.6|288.32846836847943|
|Resort Hotel|        March|    1778|57.087221597300406|            20.8| 211.7088976377952|
+------------+-------------+--------+------------------+----------------+------------------+
only showing top 20 rows
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/bivariate.py:314: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()


================================================================================
CUSTOMER BEHAVIOR CLUSTERS
================================================================================
Customer Behavior Clusters:
+-----------------+--------------+------------------+------------------+------------------+----------------+------------------+
|    customer_type|total_bookings|         avg_price|     avg_lead_time|          avg_stay|cancelation_rate| avg_booking_value|
+-----------------+--------------+------------------+------------------+------------------+----------------+------------------+
| Regular Traveler|         40531|101.16239791764157| 77.19814463003627|  3.84436604080827|            36.8| 391.6474199995032|
|    Ultra Planner|         15340| 83.31819752281757| 278.6770534550196| 3.204954367666232|            61.5| 271.1660176010446|
|    Quick Getaway|         10479|100.48768012214906|14.848840538219296| 2.160034354423132|            24.0|220.64845691382763|
|Last-Minute Short|         10271| 83.66384091130368|1.9689416804595463|1.2565475610943433|             9.0|110.20896796806538|
|Planner Long-Stay|          2082| 97.36182516810766|188.68635926993275|11.184438040345821|            31.9|1061.9778962536038|
+-----------------+--------------+------------------+------------------+------------------+----------------+------------------+

✓ Saved: bivariate/customer_behavior_clusters.png
