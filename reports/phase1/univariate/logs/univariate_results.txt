25/10/14 16:48:06 WARN Utils: Your hostname, Simarpals-MacBook-Air-3.local resolves to a loopback address: 127.0.0.1; using 192.168.0.102 instead (on interface en0)
25/10/14 16:48:06 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
25/10/14 16:48:07 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/univariate.py:101: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/univariate.py:176: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/univariate.py:264: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/univariate.py:303: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()

=== CREATING DERIVED COLUMNS ===
Derived columns created successfully!
Custumer dataset cancellation by segment:
+-------------------+--------------+-----------------+-----------------+
|market_segment_type|total_bookings|canceled_bookings|cancellation_rate|
+-------------------+--------------+-----------------+-----------------+
|      Complementary|           391|                0|              0.0|
|           Aviation|           125|               37|             29.6|
|          Corporate|          2017|              220|             10.9|
|             Online|         23214|             8475|             36.5|
|            Offline|         10528|             3153|             29.9|
+-------------------+--------------+-----------------+-----------------+

Hotel dataset cancellation by segment:
+-------------------+--------------+-----------------+-----------------+
|market_segment_type|total_bookings|canceled_bookings|cancellation_rate|
+-------------------+--------------+-----------------+-----------------+
|      Offline TA/TO|         18552|             6397|             34.5|
|      Complementary|           529|               62|             11.7|
|           Aviation|           127|               29|             22.8|
|             Direct|          7977|             1218|             15.3|
|          Undefined|             2|                2|            100.0|
|          Corporate|          3733|              594|             15.9|
|          Online TA|         33826|            11482|             33.9|
|             Groups|         13957|             8695|             62.3|
+-------------------+--------------+-----------------+-----------------+


================================================================================
PORTUGAL VS INTERNATIONAL ANALYSIS
================================================================================
Portugal analysis:
+--------------+-------------------+---------+-------------+--------+-----------------+
|total_bookings|canceled_bookings_%|avg_price|avg_lead_time|avg_stay|avg_booking_value|
+--------------+-------------------+---------+-------------+--------+-----------------+
|         35628|            1998700|    91.34|        117.8|     2.9|           274.77|
+--------------+-------------------+---------+-------------+--------+-----------------+

Other countries analysis:
+--------------+-------------------+---------+-------------+--------+-----------------+
|total_bookings|canceled_bookings_%|avg_price|avg_lead_time|avg_stay|avg_booking_value|
+--------------+-------------------+---------+-------------+--------+-----------------+
|         42670|             843600|   102.01|         88.1|     3.7|           370.38|
+--------------+-------------------+---------+-------------+--------+-----------------+


================================================================================
CITY HOTEL VS RESORT HOTEL ANALYSIS
================================================================================
CITY HOTEL Analysis:
+--------------+------------------+-----------+------------------+---------------+-------------------+
|total_bookings|cancelation_rate_%|avg_price_$|avg_lead_time_days|avg_stay_nights|avg_booking_value_$|
+--------------+------------------+-----------+------------------+---------------+-------------------+
|         51822|              41.3|     100.63|             107.5|            2.9|             291.02|
+--------------+------------------+-----------+------------------+---------------+-------------------+

RESORT HOTEL Analysis:
+--------------+------------------+-----------+------------------+---------------+-------------------+
|total_bookings|cancelation_rate_%|avg_price_$|avg_lead_time_days|avg_stay_nights|avg_booking_value_$|
+--------------+------------------+-----------+------------------+---------------+-------------------+
|         26881|              26.3|      90.17|              89.4|            4.2|             394.61|
+--------------+------------------+-----------+------------------+---------------+-------------------+


================================================================================
LEAD TIME IMPACT ON CANCELLATION
================================================================================
Cancellation Rate by Lead Time (Hotel Dataset):
+--------------------+--------------+-----------------+----------------+
|  lead_time_category|total_bookings|canceled_bookings|cancelation_rate|
+--------------------+--------------+-----------------+----------------+
|Medium Term (31-9...|         20140|             7159|            35.5|
|Last Minute (â‰¤7 d...|         13925|             1391|            10.0|
|Short Term (8-30 ...|         12602|             3342|            26.5|
|Long Term (>90 days)|         32036|            16587|            51.8|
+--------------------+--------------+-----------------+----------------+


================================================================================
MONTHLY PATTERNS
================================================================================
Monthly Patterns (Hotel Dataset):
+-------------+--------------+-----------------+----------------+------------------+------------------+
|arrival_month|total_bookings|canceled_bookings|cancelation_rate| avg_booking_value|     avg_lead_time|
+-------------+--------------+-----------------+----------------+------------------+------------------+
|         July|          7348|             2758|            37.5|470.16257076755545|124.28266194882961|
|     November|          6794|             2122|            31.2| 235.5249543715041| 76.58080659405357|
|     February|          3891|             1337|            34.4|202.57653302492952| 38.84117193523516|
|      January|          2248|              557|            24.8| 179.5795596085409| 32.52313167259786|
|        March|          4824|             1477|            30.6|254.33823590381496| 57.32607794361526|
|      October|         11160|             4246|            38.0|269.67289426523274|122.99462365591398|
|          May|          5478|             1915|            35.0|302.25258488499475|114.67433369843009|
|       August|          8952|             3423|            38.2| 513.4149798927614|111.97162645218945|
|        April|          5428|             2061|            38.0| 280.5792428150329|  85.8472733971997|
|         June|          5292|             2096|            39.6| 358.7461810279662|119.82350718065004|
|     December|          6780|             2371|            35.0|265.51514749262503| 73.56135693215339|
|    September|         10508|             4116|            39.2| 355.1500932622775|136.67519984773506|
+-------------+--------------+-----------------+----------------+------------------+------------------+

