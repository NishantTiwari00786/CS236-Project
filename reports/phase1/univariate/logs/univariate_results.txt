25/10/14 16:48:06 WARN Utils: Your hostname, Simarpals-MacBook-Air-3.local resolves to a loopback address: 127.0.0.1; using 192.168.0.102 instead (on interface en0)
25/10/14 16:48:06 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
25/10/14 16:48:07 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/univariate.py:101: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/univariate.py:176: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/univariate.py:264: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
/Users/simar/Documents/Fall25/CS236/CS236-Project/scripts/eda/univariate.py:303: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()

=== CREATING DERIVED COLUMNS ===
Derived columns created successfully!
Custumer dataset cancellation by segment:
+-------------------+--------------+-----------------+-----------------+
|market_segment_type|total_bookings|canceled_bookings|cancellation_rate|
+-------------------+--------------+-----------------+-----------------+
|      Complementary|           391|                0|              0.0|
|           Aviation|           125|               37|             29.6|
|          Corporate|          2017|              220|             10.9|
|             Online|         23214|             8475|             36.5|
|            Offline|         10528|             3153|             29.9|
+-------------------+--------------+-----------------+-----------------+

Hotel dataset cancellation by segment:
+-------------------+--------------+-----------------+-----------------+
|market_segment_type|total_bookings|canceled_bookings|cancellation_rate|
+-------------------+--------------+-----------------+-----------------+
|      Offline TA/TO|         18552|             6397|             34.5|
|      Complementary|           529|               62|             11.7|
|           Aviation|           127|               29|             22.8|
|             Direct|          7977|             1218|             15.3|
|          Undefined|             2|                2|            100.0|
|          Corporate|          3733|              594|             15.9|
|          Online TA|         33826|            11482|             33.9|
|             Groups|         13957|             8695|             62.3|
+-------------------+--------------+-----------------+-----------------+


================================================================================
PORTUGAL VS INTERNATIONAL ANALYSIS
================================================================================
Portugal analysis:
+--------------+-------------------+---------+-------------+--------+-----------------+
|total_bookings|canceled_bookings_%|avg_price|avg_lead_time|avg_stay|avg_booking_value|
+--------------+-------------------+---------+-------------+--------+-----------------+
|         35628|            1998700|    91.34|        117.8|     2.9|           274.77|
+--------------+-------------------+---------+-------------+--------+-----------------+

Other countries analysis:
+--------------+-------------------+---------+-------------+--------+-----------------+
|total_bookings|canceled_bookings_%|avg_price|avg_lead_time|avg_stay|avg_booking_value|
+--------------+-------------------+---------+-------------+--------+-----------------+
|         42670|             843600|   102.01|         88.1|     3.7|           370.38|
+--------------+-------------------+---------+-------------+--------+-----------------+



================================================================================
LEAD TIME IMPACT ON CANCELLATION
================================================================================
Cancellation Rate by Lead Time (Hotel Dataset):
+--------------------+--------------+-----------------+----------------+
|  lead_time_category|total_bookings|canceled_bookings|cancelation_rate|
+--------------------+--------------+-----------------+----------------+
|Medium Term (31-9...|         20140|             7159|            35.5|
|Last Minute (â‰¤7 d...|         13925|             1391|            10.0|
|Short Term (8-30 ...|         12602|             3342|            26.5|
|Long Term (>90 days)|         32036|            16587|            51.8|
+--------------------+--------------+-----------------+----------------+



